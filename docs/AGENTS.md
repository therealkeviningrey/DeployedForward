# Repository Guidelines

## Project Structure & Module Organization
The Next.js App Router lives in `app/`, with marketing pages under `app/(site)` and API routes in `app/api`. Shared UI sits in `components/`, while `content/` holds MDX lessons and news. Business logic, hooks, and integrations (Stripe, Better Auth, Prisma) live in `lib/`. Database schema and seeds are in `prisma/`, global styles in `styles/`, public assets in `public/`, and end-to-end specs in `tests/e2e`. Reference `docs/` for deployment and workflow playbooks.

## Build, Test, and Development Commands
Run `npm run dev` for the local server on http://localhost:3000. `npm run build` compiles a production bundle and `npm run start` serves it. Use `npm run lint` to enforce ESLint/TypeScript rules before pushing. Database helpers: `npm run db:push` syncs schema, `npm run db:migrate` creates iterative migrations, and `npm run db:seed` loads demo data via `tsx`. End-to-end suites run with `npm run test:e2e`; add `--ui` or `--debug` to inspect flaky flows.

## Coding Style & Naming Conventions
TypeScript and modern React patterns are mandatory. Prefer functional components, server actions, and Next.js conventions (`app/route.ts`, `layout.tsx`). Indent two spaces, keep files in PascalCase for components (`components/Hero.tsx`) and kebab-case for routes (`app/(site)/course-overview`). Co-locate CSS Modules (`*.module.css`) with their components. Run `npm run lint` before committing; no autogenerated formatting tool is wired, so keep diff minimal.

## Testing Guidelines
Playwright drives high-value customer journeys; place specs in `tests/e2e` with the `*.spec.ts` suffix. Ensure tests seed any required Better Auth users and tear down data they create. Aim to cover enrollment, checkout, and dashboard flows when features touch them. Use `npx playwright show-report` after runs to check regressions.

## Commit & Pull Request Guidelines
Follow the existing Conventional Commit style (`feat:`, `fix:`, `docs:`) reflected in `git log`. Branch from `preview` as `feature/<short-intent>` or `fix/<bug-tag>`, then open a PR back into `preview`. PRs must include: a concise summary, linked issue or Linear ticket, screenshots or recordings for UI changes, Playwright run output, and confirmation that database scripts were applied. Promote to `main` only after preview validation passes.

## Security & Configuration Tips
Environment templates live in `env-preview.txt` and `env-production.txt`; copy values into `.env.local` and Vercel scopes without committing secrets. Stripe webhooks require `stripe listen --forward-to localhost:3000/api/webhooks/stripe`; keep the signing secret in local env only. Monitor Sentry DSNs in `sentry.*.config.ts` when rotating keys.
